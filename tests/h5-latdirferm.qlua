require "stdlib"

fname = "xxx.h5"
Nc = 3

L = qcd.lattice{2,3,4}
v = L:DiracFermionN(Nc)
w = qcd.DiracFermionN(Nc)
for c = 0, Nc - 1 do
   for d = 0, qcd.Ns - 1 do
      w[{c=c,d=d}] = complex(10 * c + d, 10 * d + c + 0.1)
   end
end
v[{0,1,2}] = w

os.remove(fname)
x = qcd.hdf5.Writer(fname)
x:write("/sample/serial/dirferm-D", w)
x:write("/sample/serial/dirferm-F", w, {precision = "float"})
x:write("/sample/lattice/dirferm-D", v)
x:write("/sample/lattice/dirferm-F", -v, {precision = "float"})
x:close()
printf("DONE\n")