#!/bin/sh
PACKTOP=$HOME/Local/packages/macosx-20140108
Nc=3
noNc=2

#TARGET=`(cd ..; pwd)`/install
TARGET=$HOME/Local/packages/qlua-su-$Nc

# XXX Nc specific clover installation location

WOPTS='-Wno-unused-but-set-variable -Wno-unused-local-typedefs'

ARPACK_LIBS="-L$PACKTOP/arpack/lib -lparpack -larpack"
LAPACK_LIBS="-L$PACKTOP/lapack/lib -llapack"

CC='mpicc -m64 -std=c99' \
LD='mpif77 -m64 -fno-underscoring' \
CFLAGS="-Wall $WOPTS -DQDP_Nc=$Nc" \
COPTS='-O2' \
./configure                                                \
   --prefix=$TARGET                                        \
   --with-qdp=$PACKTOP/qdp                                 \
   --with-lua=$PACKTOP/lua                                 \
   --with-gsl=$PACKTOP/gsl                                 \
   --with-hdf5=$HOME/Local/packages/hdf5-1.8.10-patch1     \
   --with-mdwf=$PACKTOP/mdwf                               \
   --with-nc=$Nc                                           \
   --without-nc=$noNc                                      \
   --without-nc=N                                          \
   --with-arpack="$ARPACK_LIBS $LAPACK_LIBS"               \
   $*

#   --with-clover=$HOME/Local/packages/clover-working       \
#   --clover-nc=$Nc                                         \
