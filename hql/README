Hypre QCD Layer

See tests/hql-*.qlua for examples and correctness checks.

-- HQL grid
hg = qcd.hql{lattice = L,
             spin = 4,
             flavor = 1}

-- Plain wilson op (periodic BC)
op = hg:matrix{{ offset = { 0, 0, 0, 0}
                 gamma  = 1 },
               { offset = {-1, 0, 0, 0},
                 gamma  = - kappa * (1+gamma[mu=0]),
                 U      = U[1]:shift(0, "from_backward"):adjoin()},
               { offset = {+1, 0, 0, 0},
                 gamma  = - kappa * (1-gamma[mu=0]),
                 U      = U[1]},
               { offset = { 0, -1, 0, 0},
                 gamma  = - kappa * (1+gamma[mu=1]),
                 U      = U[2]:shift(1, "from_backward"):adjoin()},
               { offset = { 0, +1, 0, 0},
                 gamma  = - kappa * (1-gamma[mu=1]),
                 U      = U[2]},
               { offset = { 0, 0, -1, 0},
                 gamma  = - kappa * (1+gamma[mu=2]),
                 U      = U[3]:shift(2, "from_backward"):adjoin()},
               { offset = { 0, 0, +1, 0},
                 gamma  = - kappa * (1-gamma[mu=2]),
                 U      = U[3]},
               { offset = { 0, 0, 0, -1},
                 gamma  = - kappa * (1+gamma[mu=3]),
                 U      = U[4]:shift(3, "from_backward"):adjoin()},
               { offset = { 0, 0, 0, +1},
                 gamma  = - kappa * (1-gamma[mu=3]),
                 U      = U[4]}}}

-- HQL vector import
v = op:vector(DF) -- because op is on fermions

w = op:apply(v)

v_dot_w = qcd.dot(v,w)
v_norm2 = v:norm2()
w_norm2 = w:norm2()
x = v * complex(1,2) + w - 0.534 * v
qx = x:export()
